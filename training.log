Using TensorFlow backend.
preparing all images as numpy arrays ...

 total image available      862 
 no of training images:     689 
 no of test images:         86 
 no of validation images:   87
2018-08-16 10:55:04.819327: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:897] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-08-16 10:55:04.819856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:04.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-08-16 10:55:04.819902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0
2018-08-16 10:55:05.142332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-08-16 10:55:05.142393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 
2018-08-16 10:55:05.142419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N 
2018-08-16 10:55:05.142751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10759 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
Train on 689 samples, validate on 87 samples
Epoch 1/14
2018-08-16 10:55:06.027441: W tensorflow/core/framework/allocator.cc:108] Allocation of 1040449536 exceeds 10% of system memory.
2018-08-16 10:55:06.719162: W tensorflow/core/framework/allocator.cc:108] Allocation of 1040449536 exceeds 10% of system memory.
2018-08-16 10:55:06.948928: W tensorflow/core/framework/allocator.cc:108] Allocation of 1040449536 exceeds 10% of system memory.
2018-08-16 10:55:07.187183: W tensorflow/core/framework/allocator.cc:108] Allocation of 1040449536 exceeds 10% of system memory.
2018-08-16 10:55:07.416025: W tensorflow/core/framework/allocator.cc:108] Allocation of 1040449536 exceeds 10% of system memory.
689/689 [==============================] - 14s 20ms/step - loss: 12.0816 - acc: 0.2192 - val_loss: 11.8570 - val_acc: 0.2644
Epoch 2/14
689/689 [==============================] - 7s 11ms/step - loss: 11.8109 - acc: 0.2612 - val_loss: 10.8873 - val_acc: 0.2874
Epoch 3/14
689/689 [==============================] - 7s 11ms/step - loss: 8.7092 - acc: 0.4369 - val_loss: 7.6035 - val_acc: 0.4713
Epoch 4/14
689/689 [==============================] - 7s 11ms/step - loss: 2.4306 - acc: 0.8070 - val_loss: 0.8857 - val_acc: 0.8161
Epoch 5/14
689/689 [==============================] - 7s 11ms/step - loss: 0.2125 - acc: 0.9536 - val_loss: 0.1021 - val_acc: 0.9770
Epoch 6/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0613 - acc: 0.9826 - val_loss: 0.3778 - val_acc: 0.9310
Epoch 7/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0371 - acc: 0.9942 - val_loss: 0.0375 - val_acc: 0.9770
Epoch 8/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0109 - acc: 0.9971 - val_loss: 0.0359 - val_acc: 0.9885
Epoch 9/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0076 - acc: 0.9956 - val_loss: 0.0252 - val_acc: 0.9885
Epoch 10/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0057 - acc: 0.9985 - val_loss: 0.0354 - val_acc: 0.9885
Epoch 11/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0085 - acc: 0.9971 - val_loss: 0.0304 - val_acc: 0.9885
Epoch 12/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0103 - acc: 0.9985 - val_loss: 0.0568 - val_acc: 0.9885
Epoch 13/14
689/689 [==============================] - 7s 11ms/step - loss: 9.5607e-04 - acc: 1.0000 - val_loss: 0.0410 - val_acc: 0.9885
Epoch 14/14
689/689 [==============================] - 7s 11ms/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.0512 - val_acc: 0.9885
86/86 [==============================] - 0s 5ms/step
accuracy : 97.67%
loss : 0.06679941721221291
<matplotlib.figure.Figure at 0x7f04bd8624a8>